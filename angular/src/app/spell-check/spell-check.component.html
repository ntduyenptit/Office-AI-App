<div class="spell-check-container">
  <!-- File Upload Section -->
  <div class="upload-section">
    <h3>Upload Document</h3>
    <div class="upload-area" (click)="fileInput.click()">
      <input #fileInput type="file" 
             accept=".docx" 
             (change)="onFileSelect($event)" 
             style="display: none">
      <i class="fas fa-cloud-upload-alt"></i>
      <p>Click to upload a .docx file</p>
      <p *ngIf="selectedFile" class="selected-file">
        Selected: {{ selectedFile.name }}
      </p>
    </div>
  </div>

  <!-- Document Preview Section -->
  <div class="preview-section">
    <h3>Document Preview</h3>
    <div #documentContainer class="document-container"></div>
  </div>

  <!-- Analysis Section -->
  <div class="analysis-section" *ngIf="blocks.length > 0">
    <h3>Document Analysis</h3>
    <div class="blocks-list">
      <div *ngFor="let block of blocks" 
           class="block-item"
           [class.has-issues]="block.spellIssues.length > 0"
           (click)="selectBlock(block)">
        <div class="block-header">
          <span class="block-id">Block {{ block.id }}</span>
          <span class="block-style">
            {{ block.style.font }}, {{ block.style.size }}pt
            <span *ngIf="block.style.bold">Bold</span>
            <span *ngIf="block.style.italic">Italic</span>
            <span *ngIf="block.style.underline">Underline</span>
          </span>
        </div>
        <div class="block-content">{{ block.text }}</div>
        <div class="block-issues" *ngIf="block.spellIssues.length > 0">
          <div *ngFor="let issue of block.spellIssues" 
               class="issue-item"
               [class.error]="issue.severity === 'error'"
               [class.warning]="issue.severity === 'warning'"
               [class.info]="issue.severity === 'info'">
            <i class="fas" 
               [class.fa-exclamation-circle]="issue.severity === 'error'"
               [class.fa-exclamation-triangle]="issue.severity === 'warning'"
               [class.fa-info-circle]="issue.severity === 'info'">
            </i>
            {{ issue.type }}: {{ issue.word }} -> {{ issue.suggestion }}
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Suggestions Panel -->
  <div class="suggestions-panel" *ngIf="selectedBlock && showSuggestions">
    <div class="suggestions-header">
      <h3>Suggestions for Block {{ selectedBlock.id }}</h3>
      <button class="close-btn" (click)="showSuggestions = false">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="suggestions-content">
      <div *ngFor="let suggestion of selectedBlock.suggestions" 
           class="suggestion-item"
           (click)="applySuggestion(selectedBlock, suggestion)">
        {{ suggestion }}
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="action-buttons" *ngIf="blocks.length > 0">
    <button class="btn btn-primary" (click)="downloadDocument()">
      <i class="fas fa-file-word"></i> Download Corrected Document
    </button>
    <button class="btn btn-secondary" (click)="downloadAnalysis()">
      <i class="fas fa-file-excel"></i> Export Analysis
    </button>
  </div>

  <!-- Loading Indicator -->
  <div *ngIf="isLoading" class="loading-overlay">
    <div class="spinner"></div>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="alert alert-danger">
    <i class="fas fa-exclamation-circle"></i> {{ error }}
  </div>
</div> 